{
  "workflow": {
    "unique_name": "definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS",
    "name": "TALOS blog ",
    "title": "TALOS blog ",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "yusufkhan47@yahoo.co.uk",
          "scope": "local",
          "name": "email_recipient",
          "type": "datatype.string",
          "is_required": true
        },
        "unique_name": "variable_workflow_01H5NDR871RTA4dDba4PVbzRrHGbUISS7nn",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "devenvironment",
          "type": "datatype.string",
          "description": "http://www.dev78207",
          "is_required": false
        },
        "unique_name": "variable_workflow_01J4XN9YKN5OR7cB1Qaw8Ou1Hdb2P3rainB",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "target_details_tmp",
          "type": "datatype.string",
          "is_required": false
        },
        "unique_name": "variable_workflow_01H2MC1KII39V3rRVIAavDogHWd7KSvv5HQ",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "indicators",
          "type": "datatype.string",
          "is_required": false
        },
        "unique_name": "variable_workflow_01GXQKHBW4AFW29niot1QVadlr4TZXMlo9n",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "ysecurex@gmail.com",
          "scope": "local",
          "name": "email_sender",
          "type": "datatype.string",
          "is_required": true
        },
        "unique_name": "variable_workflow_01H5ND5JLMKOL1GGwNzv2yc4Epid2EXThUW",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "webex_message",
          "type": "datatype.string",
          "is_required": false
        },
        "unique_name": "variable_workflow_01H0BHHV5EU3T1vdqMdSWjYye4b59AzRVGT",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Y2lzY29zcGFyazovL3VzL1JPT00vYTUyNmI5OTAtY2NlZi0xMWVhLTgyZDktOTc4NzdlNDlhMjVl",
          "scope": "local",
          "name": "webex_team_room_id",
          "type": "datatype.string",
          "is_required": false
        },
        "unique_name": "variable_workflow_01H5OVJIZ8K8C5N0Ve7rS0GRJe7MggNdzjX",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "*****",
          "scope": "local",
          "name": "webex_token",
          "type": "datatype.secure_string",
          "is_required": false
        },
        "unique_name": "variable_workflow_01H5PBFZNRTRM1ITi4jKKFazkNjSetMigxU",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": " ",
          "scope": "local",
          "name": "CR",
          "type": "datatype.string",
          "is_required": false
        },
        "unique_name": "variable_workflow_01H2NYQFHSL1I4P7S3blZGh0sduKYT9XDMd",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "The playbook steps:\n\n1.\tGet Indicators - Make a generic http request to ACSC hosted IOC csv file, do some clean up and store the indicators\n2.\tParse IOCs - from raw text using SecureX Threat Response Inspect API\n3.\tEnrich Observables - with SecureX Threat Response Enrich API to find any global sightings (in integrated threat feeds) and more importantly local sightings/targets (in integrated security modules like Umbrella, AMP, etc.)\n4.\tShare Targets - For each module queried, if any targets founds, post on webex teams and/or send an email.\n5.\tCase Management - Create a new casebook the first time any targets are found and on subsequent runs keep updating the casebook when targets found.\n",
      "display_name": "TALOS blog ",
      "runtime_user": {
        "override_target_runtime_user": false,
        "specify_on_workflow_start": false,
        "target_default": true
      },
      "target": {
        "execute_on_target_group": true,
        "target_group": {
          "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
          "run_on_all_targets": false,
          "selected_target_types": [
            "web-service.endpoint",
            "email.smtp_endpoint"
          ],
          "use_criteria": {
            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
            "conditions": [
              {
                "operator": "eq",
                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                "right_operand": "CTR_API"
              }
            ]
          }
        }
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01H03W7H2BVYX6JXENPNSVWNPQ5vpncfcuN",
        "name": "Group",
        "title": "GET INDICATORS",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "GET INDICATORS",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01GXPO54I104X1NSFLAOl5D7QxWSFthjBWF",
            "name": "HTTP Request",
            "title": "HTTP Request",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "content_type": "text/plain",
              "continue_on_error_status_code": false,
              "continue_on_failure": false,
              "display_name": "HTTP Request",
              "method": "GET",
              "runtime_user": {
                "override_target_runtime_user": false,
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target": true,
                "target_id": "definition_target_01H2HPUTD521U6xZCMTTwUVWART8BSxFwHG"
              },
              "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01GXRSYUEO9NZ7cPmdgWXUu7zSfWCMp3GIH",
            "name": "Replace String",
            "title": "Clean up text",
            "type": "core.replacestring",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "description": "Delete parantecies and escape \"escape\" character",
              "display_name": "Clean up text",
              "input_string": "$activity.definition_activity_01GXPO54I104X1NSFLAOl5D7QxWSFthjBWF.output.response_body$",
              "replace_list": [
                {
                  "replaced_string": "\"",
                  "replacement_string": ""
                },
                {
                  "replaced_string": "\\",
                  "replacement_string": "\\\\"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01GXROGRSVNW32rY1L392vgCVKJdJjJP2mb",
            "name": "Execute Python Script",
            "title": "Delete special characters",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "description": "Delete special characters such as end of line",
              "display_name": "Delete special characters",
              "script": "input = r\"\"\"$activity.definition_activity_01GXRSYUEO9NZ7cPmdgWXUu7zSfWCMp3GIH.output.result_string$\"\"\"\nnewtext = input.replace(\"\\n\",\" \")",
              "script_queries": [
                {
                  "script_query": "newtext",
                  "script_query_name": "newtext",
                  "script_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01GXQJZZUPE6N5CGTRBJPNDekI5bjMWoaII",
            "name": "Set Variables",
            "title": "Save indicators",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "description": "Save indicators to a local variable called \"indicators\"",
              "display_name": "Save indicators",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01GXQKHBW4AFW29niot1QVadlr4TZXMlo9n$",
                  "variable_value_new": "$activity.definition_activity_01GXROGRSVNW32rY1L392vgCVKJdJjJP2mb.output.script_queries.newtext$"
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01H03Y6PIWPY63AEhU6ljE4FKBzCvcLQWea",
        "name": "Group",
        "title": "Parse IOCs",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Parse IOCs",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01H5N6CXBK8KL3HPGjuxUliHh2KSV5PZVCG",
            "name": "CTR Generate Access Token",
            "title": "CTR Generate Access Token",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "CTR Generate Access Token",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eq",
                        "right_operand": "CTR_For_Access_Token"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01779LB6MV0P02kvka9TGV5cEam84NrCTy4"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01GZ8U4R6533X3CAeJH39zViJ5tl9PJ6fHz",
            "name": "Inspect observables with Threat Response",
            "title": "Inspect observables with Threat Response",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "description": "Convert unformatted text from ACSC Advirosy list into formatted list of observables",
              "display_name": "Inspect observables with Threat Response",
              "input": {
                "variable_workflow_01C9F46FN86EW70gxvx7jTcwKMObdpaAPck": "$activity.definition_activity_01GXROGRSVNW32rY1L392vgCVKJdJjJP2mb.output.script_queries.newtext$",
                "variable_workflow_01C9F4PDGN5725qpK8sofdFmV1hrTAcYaGb": "$activity.definition_activity_01H5N6CXBK8KL3HPGjuxUliHh2KSV5PZVCG.output.variable_workflow_01BNOOXA3G6MV1PGAvsfZOKDdMYcE6XS726$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eq",
                        "right_operand": "CTR_API"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01C9F1VJ1I5KH26f860hJC5zDSD33548bYS"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01H043LO2UQT56v5oHDJCiDS46y2zgShah1",
            "name": "Read Table from JSON",
            "title": "Populate tabele of IOCs",
            "type": "corejava.read_table_from_json",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "description": "Save observables to the table",
              "display_name": "Populate tabele of IOCs",
              "input_json": "$activity.definition_activity_01GZ8U4R6533X3CAeJH39zViJ5tl9PJ6fHz.output.variable_workflow_01C9F6MICKTEV29S3eyPNTv36WARzQzopHd$",
              "jsonpath_query": "$.*",
              "persist_output": true,
              "populate_columns": false,
              "skip_execution": false,
              "table_columns": [
                {
                  "column_name": "type",
                  "column_type": "string"
                },
                {
                  "column_name": "value",
                  "column_type": "string"
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01H099S7ZTHZ71dyV7kl5XHzEVGX76bdwwE",
        "name": "Group",
        "title": "Enrich Observables",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Enrich Observables",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01H098VCRVMOR3jAd4fRZsbfzPCIFJBZ64l",
            "name": "CTRGenerateAccessToken",
            "title": "CTRGenerateAccessToken",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "CTRGenerateAccessToken",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eq",
                        "right_operand": "CTR_For_Access_Token"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01779LB6MV0P02kvka9TGV5cEam84NrCTy4"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01H09G8NJGW4T3dzJGwbYnCMpJQKIzer5cc",
            "name": "HTTP Request",
            "title": "Enrich Observables",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "accept": "application/json",
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "body": "$activity.definition_activity_01GZ8U4R6533X3CAeJH39zViJ5tl9PJ6fHz.output.variable_workflow_01C9F6MICKTEV29S3eyPNTv36WARzQzopHd$",
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": false,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "Bearer $activity.definition_activity_01H098VCRVMOR3jAd4fRZsbfzPCIFJBZ64l.output.variable_workflow_01BNOOXA3G6MV1PGAvsfZOKDdMYcE6XS726$"
                }
              ],
              "description": "Observe an Entity - return Sightings from your modules about any of the above entity types. Sighting - an observation of an observable. For example, an endpoint detecting a file hash detected on a filesystem, or on the network by a firewall.",
              "display_name": "Enrich Observables",
              "method": "POST",
              "relative_url": "/iroh-enrich/observe/observables",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eq",
                        "right_operand": "CTR_API"
                      }
                    ]
                  }
                }
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01H09KN83ISMF7MgnIcSsya0lpXEze03i4d",
            "name": "Read Table from JSON",
            "title": "Populate table with results for each module",
            "type": "corejava.read_table_from_json",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "description": "Populate table with results for each module",
              "display_name": "Populate table with results for each module",
              "input_json": "$activity.definition_activity_01H09G8NJGW4T3dzJGwbYnCMpJQKIzer5cc.output.response_body$",
              "jsonpath_query": "$.data[*]",
              "persist_output": true,
              "populate_columns": false,
              "skip_execution": false,
              "table_columns": [
                {
                  "column_name": "module",
                  "column_type": "string"
                },
                {
                  "column_name": "data",
                  "column_type": "string"
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01H09MMM0066W0Qj3WgfQQivlYfQnViYJGl",
        "name": "For Each",
        "title": "For Each Module",
        "type": "logic.for_each",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "For Each Module",
          "skip_execution": false,
          "source_array": "$activity.definition_activity_01H09KN83ISMF7MgnIcSsya0lpXEze03i4d.output.read_table_from_json$"
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01H09N4KGSUTM1URrluQqHI3j5Aw2VGu62z",
            "name": "Read Table from JSON",
            "title": "Read Targets",
            "type": "corejava.read_table_from_json",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Read Targets",
              "input_json": "$activity.definition_activity_01H09MMM0066W0Qj3WgfQQivlYfQnViYJGl.input.source_array[@].data$",
              "jsonpath_query": "$..sightings.docs[*].targets[*]",
              "persist_output": true,
              "populate_columns": false,
              "skip_execution": false,
              "table_columns": [
                {
                  "column_name": "type",
                  "column_type": "string"
                },
                {
                  "column_name": "observables",
                  "column_type": "string"
                },
                {
                  "column_name": "observed_time",
                  "column_type": "string"
                }
              ]
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01H09WA14ULX146m2NQIuOn7HIWSQk4MzHB",
            "name": "Condition Block",
            "title": "Found targets",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Found targets",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01H09WA4UW5680mWGhDlKIZ5DV1s6VRNKre",
                "name": "Condition Branch",
                "title": "Yes",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01H09N4KGSUTM1URrluQqHI3j5Aw2VGu62z.output.succeeded$",
                    "operator": "eq",
                    "right_operand": true
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01J4HDBY9OF9P2AaLZaTAOveNB9WqaDSsgd",
                    "name": "Service Now - Create Incident",
                    "title": "Service Now - Create Incident",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Service Now - Create Incident",
                      "input": {
                        "variable_workflow_01C0CK2MY2SLG1FXph6ZHp7iHmRw1KvUFlN": "Information for ServiceNow Incident",
                        "variable_workflow_01FGYF0DUR8HV2TMpEKctsYjQR4mzjD5OTu": "**Module:** $activity.definition_activity_01H09MMM0066W0Qj3WgfQQivlYfQnViYJGl.input.source_array[@].module$ \\n**Found sightings:*$activity.definition_activity_01H09N4KGSUTM1URrluQqHI3j5Aw2VGu62z.output.row_count$  \\n**Target details:** [$activity.Read Targets.output.Output[0].observables$]  \\n**Time:** [$activity.Read Targets.output.Output[0].observed_time$]",
                        "variable_workflow_01FGYGCZL5M2E1m1O5tvVVn0DVzVTLwytei": 1,
                        "variable_workflow_01FGYGPFJYM4L5aVpzNOhRwMmzKJDofqufe": 2,
                        "variable_workflow_01FGYGZ0OYYNM5pWjyyreMjNHDjusjNe8jx": "",
                        "variable_workflow_01FGYI8HES41K63G3UzMinBH3iApm37fBGt": "yusufkhan",
                        "variable_workflow_01FMQD0HIJIDU5kce0VNx4HQiMYjMfUvBlj": "v2"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target": true,
                        "target_id": "definition_target_01IWXF91FHMFY2H0XMMpX4euqKeL9ZfXfQa",
                        "target_type": "web-service.endpoint"
                      },
                      "workflow_id": "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01J4UW92ETU0C3AygMMMu9yoN6hAyRzejgh",
                    "name": "HTTP Request",
                    "title": "Service Now- Get Incident",
                    "type": "web-service.http_request",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "allow_auto_redirect": true,
                      "continue_on_error_status_code": false,
                      "continue_on_failure": false,
                      "display_name": "Service Now- Get Incident",
                      "method": "GET",
                      "relative_url": "now/table/incident/$activity.definition_activity_01J4HDBY9OF9P2AaLZaTAOveNB9WqaDSsgd.output.variable_workflow_01C0F7F9L7IYM3YXHCizJhunwKtPlSJWEWM$",
                      "runtime_user": {
                        "override_target_runtime_user": false,
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target": true,
                        "target_id": "definition_target_01IWXF91FHMFY2H0XMMpX4euqKeL9ZfXfQa"
                      }
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01J4WAW87NUWQ1qyMTrJCmgS2NPcSW8hMYF",
                    "name": "JSONPath Query",
                    "title": "JSONPath Query",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "JSONPath Query",
                      "input_json": "$activity.definition_activity_01J4HDBY9OF9P2AaLZaTAOveNB9WqaDSsgd.output.variable_workflow_01C0C3F7WJAUK0TfekEO4H2SeSvFJxIC38A$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "result.opened_by.value",
                          "jsonpath_query_name": "openedlink",
                          "jsonpath_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01H0BO0Z5OBC43pabXROdf3EM6uS2f9uvY2",
                    "name": "Set Variables",
                    "title": "Construct Webex Team Message",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Construct Webex Team Message",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H0BHHV5EU3T1vdqMdSWjYye4b59AzRVGT$",
                          "variable_value_new": "**Module:** $activity.definition_activity_01H09MMM0066W0Qj3WgfQQivlYfQnViYJGl.input.source_array[@].module$  \\n**Found sightings:** $activity.definition_activity_01H09N4KGSUTM1URrluQqHI3j5Aw2VGu62z.output.row_count$  \\n**Target details:** $activity.definition_activity_01H09N4KGSUTM1URrluQqHI3j5Aw2VGu62z.output.read_table_from_json[0].observables$  \\n**Time:** $activity.definition_activity_01H09N4KGSUTM1URrluQqHI3j5Aw2VGu62z.output.read_table_from_json[0].observed_time$\\n[Servicenow Incident](https://dev78207.service-now.com/nav_to.do?uri=incident.do?sys_id=$activity.definition_activity_01J4HDBY9OF9P2AaLZaTAOveNB9WqaDSsgd.output.variable_workflow_01C0F7F9L7IYM3YXHCizJhunwKtPlSJWEWM$)"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01H2MCDAZK0DJ0sTj4XDPlowUcFU3kEZz1s",
                    "name": "Replace String",
                    "title": "Delete special characters",
                    "type": "core.replacestring",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Delete special characters",
                      "input_string": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H0BHHV5EU3T1vdqMdSWjYye4b59AzRVGT$",
                      "replace_list": [
                        {
                          "replaced_string": "\"",
                          "replacement_string": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H2NYQFHSL1I4P7S3blZGh0sduKYT9XDMd$"
                        },
                        {
                          "replaced_string": "},{",
                          "replacement_string": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H2NYQFHSL1I4P7S3blZGh0sduKYT9XDMd$$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H2NYQFHSL1I4P7S3blZGh0sduKYT9XDMd$\\n"
                        },
                        {
                          "replaced_string": "[{",
                          "replacement_string": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H2NYQFHSL1I4P7S3blZGh0sduKYT9XDMd$$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H2NYQFHSL1I4P7S3blZGh0sduKYT9XDMd$\\n"
                        },
                        {
                          "replaced_string": "}]",
                          "replacement_string": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H2NYQFHSL1I4P7S3blZGh0sduKYT9XDMd$$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H2NYQFHSL1I4P7S3blZGh0sduKYT9XDMd$\\n"
                        },
                        {
                          "replaced_string": "{",
                          "replacement_string": ""
                        },
                        {
                          "replaced_string": "}",
                          "replacement_string": ""
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01H0AX6DRW4DE7RNHJLOzDKI28Zoabtg9RW",
                    "name": "Webex Teams - Post Message to Room",
                    "title": "Webex Teams - Post Message to Room",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Webex Teams - Post Message to Room",
                      "input": {
                        "variable_workflow_01FGYY44G3MZ55amJu9YqgUeKS8GT49bZx3": "$global.variable_01H0BNK7MLU3M6Bcnlz5qZqYbUrp2zVjnTM.global.variable_01H0BNK7MLU3M6Bcnlz5qZqYbUrp2zVjnTM$",
                        "variable_workflow_01FGYY44G3TK951Crpnd8g2izonyM4bFtpW": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H5OVJIZ8K8C5N0Ve7rS0GRJe7MggNdzjX$",
                        "variable_workflow_01FGYY44G3UPV3heGGc3vXCV47YL5WoI2X6": "",
                        "variable_workflow_01FGYZ9BV4QTP19CuMwcW8QywvCP9ymx2BZ": "$activity.definition_activity_01H2MCDAZK0DJ0sTj4XDPlowUcFU3kEZz1s.output.result_string$"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eq",
                                "right_operand": "Webex_Teams_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01FGYY44YU521254ygN3Le0In0kEHpiPNpf"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01H0AF2RGCEHD06AWjd3dbzx1KzU0Em9p8O",
                    "name": "Send Email",
                    "title": "Send Email",
                    "type": "email.smtp_send_email",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "body": "\u003cbr\u003eModule: $activity.definition_activity_01H09MMM0066W0Qj3WgfQQivlYfQnViYJGl.input.source_array[@].module$\u003c/br\u003e\n\u003cbr\u003eFound sightings: $activity.definition_activity_01H09N4KGSUTM1URrluQqHI3j5Aw2VGu62z.output.row_count$\u003c/br\u003e\n\u003cbr\u003eTarget details: $activity.definition_activity_01H09N4KGSUTM1URrluQqHI3j5Aw2VGu62z.output.read_table_from_json[0].observables$\u003c/br\u003e\n\u003cbr\u003eTime: $activity.definition_activity_01H09N4KGSUTM1URrluQqHI3j5Aw2VGu62z.output.read_table_from_json[0].observed_time$\u003c/br\u003e",
                      "continue_if_one_address_valid": false,
                      "continue_on_failure": true,
                      "display_name": "Send Email",
                      "from": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H5ND5JLMKOL1GGwNzv2yc4Epid2EXThUW$",
                      "html": true,
                      "runtime_user": {
                        "override_target_runtime_user": true,
                        "runtime_user_id": "definition_runtime_user_01GFAQTZ3SASL3P3gXTzgYnUci8nvASuOie"
                      },
                      "skip_execution": false,
                      "subject": "Found targets",
                      "target": {
                        "override_workflow_target": true,
                        "target_id": "definition_target_01H2XVG347BDV6wnJwP8lBId0b7PbosnmZX"
                      },
                      "to": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H5NDR871RTA4dDba4PVbzRrHGbUISS7nn$"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01H09WA624XST4KuXl8Wt0d7BcTBYPuE8Ra",
                "name": "Condition Branch",
                "title": "No",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01H09N4KGSUTM1URrluQqHI3j5Aw2VGu62z.output.succeeded$",
                    "operator": "eq",
                    "right_operand": false
                  },
                  "continue_on_failure": false,
                  "display_name": "No",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01H0BH86O21UI1YNTiTriWi2nCToVCh0ECR",
                    "name": "Set Variables",
                    "title": "Construct Webex Team Message",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "description": "Construct Webex Team Message",
                      "display_name": "Construct Webex Team Message",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H0BHHV5EU3T1vdqMdSWjYye4b59AzRVGT$",
                          "variable_value_new": "**Module:** $activity.definition_activity_01H09MMM0066W0Qj3WgfQQivlYfQnViYJGl.input.source_array[@].module$  \\n Did not find any target for these observables."
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01H0B35Y2U2PR2KHKmasDhHS8VTL6az0WO2",
                    "name": "Webex Teams - Post Message to Room",
                    "title": "Webex Teams - Post Message to Room",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Webex Teams - Post Message to Room",
                      "input": {
                        "variable_workflow_01FGYY44G3MZ55amJu9YqgUeKS8GT49bZx3": "$global.variable_01H0BNK7MLU3M6Bcnlz5qZqYbUrp2zVjnTM.global.variable_01H0BNK7MLU3M6Bcnlz5qZqYbUrp2zVjnTM$",
                        "variable_workflow_01FGYY44G3TK951Crpnd8g2izonyM4bFtpW": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H5OVJIZ8K8C5N0Ve7rS0GRJe7MggNdzjX$",
                        "variable_workflow_01FGYY44G3UPV3heGGc3vXCV47YL5WoI2X6": "",
                        "variable_workflow_01FGYZ9BV4QTP19CuMwcW8QywvCP9ymx2BZ": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H0BHHV5EU3T1vdqMdSWjYye4b59AzRVGT$"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "use_workflow_target_group": true
                      },
                      "workflow_id": "definition_workflow_01FGYY44YU521254ygN3Le0In0kEHpiPNpf"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01H0ANPG29AHC0hsuP9pnUC1Tnh4Gdcmx6K",
                    "name": "Send Email",
                    "title": "Send Email",
                    "type": "email.smtp_send_email",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "body": "Module $activity.definition_activity_01H09MMM0066W0Qj3WgfQQivlYfQnViYJGl.input.source_array[@].module$ did not find any targets associated with these observables.",
                      "continue_if_one_address_valid": false,
                      "continue_on_failure": true,
                      "display_name": "Send Email",
                      "from": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H5ND5JLMKOL1GGwNzv2yc4Epid2EXThUW$",
                      "html": true,
                      "runtime_user": {
                        "override_target_runtime_user": true,
                        "runtime_user_id": "definition_runtime_user_01GFAQTZ3SASL3P3gXTzgYnUci8nvASuOie"
                      },
                      "skip_execution": false,
                      "subject": "No Targets found",
                      "target": {
                        "override_workflow_target": true,
                        "target_id": "definition_target_01H2XVG347BDV6wnJwP8lBId0b7PbosnmZX"
                      },
                      "to": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H5NDR871RTA4dDba4PVbzRrHGbUISS7nn$"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01H5OAXV8PIIR2KEQhVEom36D4PPrQT27Tr",
        "name": "Group",
        "title": "Create or Update Casebook",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Create or Update Casebook",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01H5OI7ZFC55I4iNTnSGQd8cs4uasJzC5tV",
            "name": "CTR Generate Access Token",
            "title": "CTR Generate Access Token",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "CTR Generate Access Token",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eq",
                        "right_operand": "CTR_For_Access_Token"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01779LB6MV0P02kvka9TGV5cEam84NrCTy4"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01H5OB8OYTE7L06ZOl0bWpp3BLWOFi1ivmO",
            "name": "CTR Create Casebook",
            "title": "CTR Create Casebook",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "CTR Create Casebook",
              "input": {
                "variable_workflow_01E8OQUDV95VA45dnDR0Kzm5HlMxNSnk7HH": "$activity.definition_activity_01H5OI7ZFC55I4iNTnSGQd8cs4uasJzC5tV.output.variable_workflow_01BNOOXA3G6MV1PGAvsfZOKDdMYcE6XS726$",
                "variable_workflow_01FI7GJDK40MI6qNg2jcng0YaHlmz0Zgwq5": "SecureX Created this casebook for TALOS weekly blog Observables",
                "variable_workflow_01FI7JJEVXRFA5s9maRdVwlqV7ENc6KhST2": "TALOS Weekly Update 21st October Casebook",
                "variable_workflow_01FI7NA9QZI9I46crflRbf7I6zIfajxuHrX": "$activity.definition_activity_01GZ8U4R6533X3CAeJH39zViJ5tl9PJ6fHz.output.variable_workflow_01C9F6MICKTEV29S3eyPNTv36WARzQzopHd$",
                "variable_workflow_01FRLITVY3NO678mmPZHG5lCdqLjEyY2j1h": "raw"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eq",
                        "right_operand": "Private_CTIA_Target"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01DS6ELBOO8YR3uFJZju566LqiqR18VlE6r"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01H5PE7NR5Y3O6nsHpipvFlQ9Sg9RFDOoBp",
            "name": "HTTP Request",
            "title": "Check if Casebook Exists",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "accept": "application/json",
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "Bearer $activity.definition_activity_01H5OI7ZFC55I4iNTnSGQd8cs4uasJzC5tV.output.variable_workflow_01BNOOXA3G6MV1PGAvsfZOKDdMYcE6XS726$"
                }
              ],
              "display_name": "Check if Casebook Exists",
              "method": "GET",
              "relative_url": "/ctia/casebook/$global.variable_01H5OJTIZW5CP2o27dFtWQ7Rw2m0l6FQDku.global.variable_01H5OJTIZW5CP2o27dFtWQ7Rw2m0l6FQDku$",
              "runtime_user": {
                "override_target_runtime_user": false,
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eq",
                        "right_operand": "Private_CTIA_Target"
                      }
                    ]
                  }
                }
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01H5OH7WVVWZD2LdkuLg1N4UxXP989wyfxL",
            "name": "Condition Block",
            "title": "Casebook already exists",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Casebook already exists",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01H5OH837YZZL6j2eDBQYVUR8HnuJ6NrnsI",
                "name": "Condition Branch",
                "title": "Yes",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01H5PE7NR5Y3O6nsHpipvFlQ9Sg9RFDOoBp.output.succeeded$",
                    "operator": "eq",
                    "right_operand": true
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01H5OM5DQIKJK5vTBcOwnICnQgmsR09avle",
                    "name": "HTTP Request",
                    "title": "CTR Update Casebook",
                    "type": "web-service.http_request",
                    "base_type": "activity",
                    "properties": {
                      "accept": "application/json",
                      "action_timeout": 180,
                      "allow_auto_redirect": true,
                      "body": "{\n  \"operation\": \"replace\",\n  \"observables\": $activity.definition_activity_01GZ8U4R6533X3CAeJH39zViJ5tl9PJ6fHz.output.variable_workflow_01C9F6MICKTEV29S3eyPNTv36WARzQzopHd$\n}",
                      "content_type": "application/json",
                      "continue_on_error_status_code": false,
                      "continue_on_failure": false,
                      "custom_headers": [
                        {
                          "name": "Authorization",
                          "value": "Bearer $activity.definition_activity_01H5OI7ZFC55I4iNTnSGQd8cs4uasJzC5tV.output.variable_workflow_01BNOOXA3G6MV1PGAvsfZOKDdMYcE6XS726$"
                        }
                      ],
                      "display_name": "CTR Update Casebook",
                      "method": "POST",
                      "relative_url": "/ctia/casebook/$global.variable_01H5OJTIZW5CP2o27dFtWQ7Rw2m0l6FQDku.global.variable_01H5OJTIZW5CP2o27dFtWQ7Rw2m0l6FQDku$/observables",
                      "runtime_user": {
                        "override_target_runtime_user": false,
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eq",
                                "right_operand": "Private_CTIA_Target"
                              }
                            ]
                          }
                        }
                      }
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01H5OW7GL94PG7IUTK5BnypqtezSGHaLGmm",
                    "name": "Webex Teams - Post Message to Room",
                    "title": "Webex Teams - Post Message to Room",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Webex Teams - Post Message to Room",
                      "input": {
                        "variable_workflow_01FGYY44G3MZ55amJu9YqgUeKS8GT49bZx3": "$global.variable_01H0BNK7MLU3M6Bcnlz5qZqYbUrp2zVjnTM.global.variable_01H0BNK7MLU3M6Bcnlz5qZqYbUrp2zVjnTM$",
                        "variable_workflow_01FGYY44G3TK951Crpnd8g2izonyM4bFtpW": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.local.variable_workflow_01H5OVJIZ8K8C5N0Ve7rS0GRJe7MggNdzjX$",
                        "variable_workflow_01FGYY44G3UPV3heGGc3vXCV47YL5WoI2X6": "",
                        "variable_workflow_01FGYZ9BV4QTP19CuMwcW8QywvCP9ymx2BZ": "**SecureX has updated Threat Reponse Casebook.**  \\nCasebook ID: $global.variable_01H5OJTIZW5CP2o27dFtWQ7Rw2m0l6FQDku.global.variable_01H5OJTIZW5CP2o27dFtWQ7Rw2m0l6FQDku$"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eq",
                                "right_operand": "Webex_Teams_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01FGYY44YU521254ygN3Le0In0kEHpiPNpf"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01H5OH84LAWC052yg59qc8CGepG7ZYHxm1H",
                "name": "Condition Branch",
                "title": "No",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01H5PE7NR5Y3O6nsHpipvFlQ9Sg9RFDOoBp.output.succeeded$",
                    "operator": "eq",
                    "right_operand": "false"
                  },
                  "continue_on_failure": false,
                  "display_name": "No",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01J4YY5F4A2JF2AJmjEujxkZHSq0WMKVpfV",
                    "name": "CTR Create Casebook",
                    "title": "CTR Create Casebook",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "CTR Create Casebook",
                      "input": {
                        "variable_workflow_01E8OQUDV95VA45dnDR0Kzm5HlMxNSnk7HH": "$activity.definition_activity_01H5OI7ZFC55I4iNTnSGQd8cs4uasJzC5tV.output.variable_workflow_01BNOOXA3G6MV1PGAvsfZOKDdMYcE6XS726$",
                        "variable_workflow_01FI7GJDK40MI6qNg2jcng0YaHlmz0Zgwq5": "SecureX Created this casebook for TALOS weekly blog Observables",
                        "variable_workflow_01FI7JJEVXRFA5s9maRdVwlqV7ENc6KhST2": "TALOS Weekly Update 21st October Casebook",
                        "variable_workflow_01FI7NA9QZI9I46crflRbf7I6zIfajxuHrX": "$activity.definition_activity_01GZ8U4R6533X3CAeJH39zViJ5tl9PJ6fHz.output.variable_workflow_01C9F6MICKTEV29S3eyPNTv36WARzQzopHd$",
                        "variable_workflow_01FRLITVY3NO678mmPZHG5lCdqLjEyY2j1h": "raw"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eq",
                                "right_operand": "Private_CTIA_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01DS6ELBOO8YR3uFJZju566LqiqR18VlE6r"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01H5P5WE2X8MJ2BoFmhOFEFAIjU2fycIBCl",
                    "name": "Substring",
                    "title": "Substring",
                    "type": "core.substring",
                    "base_type": "activity",
                    "properties": {
                      "begin": 54,
                      "continue_on_failure": false,
                      "display_name": "Substring",
                      "end": 99,
                      "skip_execution": false,
                      "source": "$activity.definition_activity_01H5OB8OYTE7L06ZOl0bWpp3BLWOFi1ivmO.output.variable_workflow_01DSFE4QJSRYK67ewkTPGkJ0WaGxQSw7KjQ$"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01H5OK7G8O6JO7SCwD1HcwbIHaQ0O892HaM",
                    "name": "Set Variables",
                    "title": "Update casebook variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Update casebook variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$global.variable_01H5OJTIZW5CP2o27dFtWQ7Rw2m0l6FQDku.global.variable_01H5OJTIZW5CP2o27dFtWQ7Rw2m0l6FQDku$",
                          "variable_value_new": "$activity.definition_activity_01H5P5WE2X8MJ2BoFmhOFEFAIjU2fycIBCl.output.substring$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01H5OTDE0G4KK2c1Pb01tRzkCiQwZgHHW14",
                    "name": "Webex Teams - Post Message to Room",
                    "title": "Webex Teams - Post Message to Room",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Webex Teams - Post Message to Room",
                      "input": {
                        "variable_workflow_01FGYY44G3MZ55amJu9YqgUeKS8GT49bZx3": "$global.variable_01H0BNK7MLU3M6Bcnlz5qZqYbUrp2zVjnTM.global.variable_01H0BNK7MLU3M6Bcnlz5qZqYbUrp2zVjnTM$",
                        "variable_workflow_01FGYY44G3TK951Crpnd8g2izonyM4bFtpW": "$workflow.definition_workflow_01GXPG9L9I6U91z2JiGyf9TEQ5lvFBgeOtS.input.variable_workflow_01H5OVJIZ8K8C5N0Ve7rS0GRJe7MggNdzjX$",
                        "variable_workflow_01FGYY44G3UPV3heGGc3vXCV47YL5WoI2X6": "SecureX have created Threat Reponse Casebook. Casebook ID: $global.variable_01H5OJTIZW5CP2o27dFtWQ7Rw2m0l6FQDku.global.variable_01H5OJTIZW5CP2o27dFtWQ7Rw2m0l6FQDku$",
                        "variable_workflow_01FGYZ9BV4QTP19CuMwcW8QywvCP9ymx2BZ": "**SecureX has created Threat Reponse Casebook.**  \\nCasebook ID: $global.variable_01H5OJTIZW5CP2o27dFtWQ7Rw2m0l6FQDku.global.variable_01H5OJTIZW5CP2o27dFtWQ7Rw2m0l6FQDku$"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eq",
                                "right_operand": "Webex_Teams_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01FGYY44YU521254ygN3Le0In0kEHpiPNpf"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ]
  },
  "targets": {
    "definition_target_01H2HPUTD521U6xZCMTTwUVWART8BSxFwHG": {
      "unique_name": "definition_target_01H2HPUTD521U6xZCMTTwUVWART8BSxFwHG",
      "name": "test",
      "title": "test",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "disable_certificate_validation": true,
        "display_name": "test",
        "host": "blog.talosintelligence.com",
        "ignore_proxy": false,
        "no_runtime_user": true,
        "path": "2020/10/threat-source-newsletter-for-oct-1-2020.html",
        "port": 443,
        "protocol": "https"
      }
    },
    "definition_target_01H2XVG347BDV6wnJwP8lBId0b7PbosnmZX": {
      "unique_name": "definition_target_01H2XVG347BDV6wnJwP8lBId0b7PbosnmZX",
      "name": "yusufkha_email",
      "title": "yusufkha_email",
      "type": "email.smtp_endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "default_runtime_user_id": "definition_runtime_user_01GFAQTZ3SASL3P3gXTzgYnUci8nvASuOie",
        "display_name": "yusufkha_email",
        "no_runtime_user": false,
        "port": 465,
        "protocol": "SMTP",
        "server": "smtp.gmail.com"
      }
    },
    "definition_target_01IWXF91FHMFY2H0XMMpX4euqKeL9ZfXfQa": {
      "unique_name": "definition_target_01IWXF91FHMFY2H0XMMpX4euqKeL9ZfXfQa",
      "name": "servicenow",
      "title": "servicenow",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "default_runtime_user_id": "definition_runtime_user_01IWXEYSI5B740JieoR2iz004GlEpbbkcpl",
        "disable_certificate_validation": false,
        "display_name": "servicenow",
        "host": "dev78207.service-now.com",
        "ignore_proxy": false,
        "no_runtime_user": false,
        "path": "/api",
        "protocol": "https"
      }
    }
  },
  "runtime_users": {
    "definition_runtime_user_01GFAQTZ3SASL3P3gXTzgYnUci8nvASuOie": {
      "unique_name": "definition_runtime_user_01GFAQTZ3SASL3P3gXTzgYnUci8nvASuOie",
      "name": "Gmail_Credentials",
      "title": "Gmail_Credentials",
      "type": "runtime_user.email_credentials",
      "base_type": "runtime_user",
      "object_type": "definition_runtime_user",
      "properties": {
        "display_name": "Gmail_Credentials",
        "password": "*****",
        "sender": "*****"
      }
    },
    "definition_runtime_user_01IWXEYSI5B740JieoR2iz004GlEpbbkcpl": {
      "unique_name": "definition_runtime_user_01IWXEYSI5B740JieoR2iz004GlEpbbkcpl",
      "name": "servicenow credentials",
      "title": "servicenow credentials",
      "type": "runtime_user.web-service_basic_credentials",
      "base_type": "runtime_user",
      "object_type": "definition_runtime_user",
      "properties": {
        "auth_option": "*****",
        "basic_password": "*****",
        "basic_username": "*****",
        "display_name": "servicenow credentials"
      }
    }
  },
  "target_groups": {
    "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
      "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
      "name": "Default TargetGroup",
      "title": "Default TargetGroup",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "web-service.endpoint",
          "view_target_type": "web-service.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "email.smtp_endpoint",
          "view_target_type": "email.smtp_endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "variables": {
    "variable_01H0BNK7MLU3M6Bcnlz5qZqYbUrp2zVjnTM": {
      "unique_name": "variable_01H0BNK7MLU3M6Bcnlz5qZqYbUrp2zVjnTM",
      "properties": {
        "value": "*****",
        "scope": "global",
        "name": "Webex Teams Bot Token",
        "type": "datatype.secure_string",
        "is_required": false
      },
      "object_type": "variable"
    },
    "variable_01H5OJTIZW5CP2o27dFtWQ7Rw2m0l6FQDku": {
      "unique_name": "variable_01H5OJTIZW5CP2o27dFtWQ7Rw2m0l6FQDku",
      "properties": {
        "value": "ok/casebook-993c9b9f-f236-4217-846d-6d30685db",
        "scope": "global",
        "name": "casebook_id",
        "type": "datatype.string",
        "is_required": false
      },
      "object_type": "variable"
    }
  },
  "atomic_workflows": [
    "definition_workflow_01C9F1VJ1I5KH26f860hJC5zDSD33548bYS",
    "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW",
    "definition_workflow_01DS6ELBOO8YR3uFJZju566LqiqR18VlE6r",
    "definition_workflow_01FGYY44YU521254ygN3Le0In0kEHpiPNpf",
    "definition_workflow_01779LB6MV0P02kvka9TGV5cEam84NrCTy4"
  ]
}